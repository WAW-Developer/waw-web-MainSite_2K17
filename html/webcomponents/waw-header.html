
<dom-module id="waw-header">
  
  <!-- special import with type=css used to load remote CSS
       Note: this style of importing CSS is deprecated -->
  <link rel="import" type="css" href="../js/tether/tether.min.css">
  <link rel="import" type="css" href="../js/bootstrap/js/bootstrap.min.css">
  
  <link rel="import" type="css" href="../js/font-awesome/css/font-awesome.min.css">
  
  
  <template>
    <style>
      /* local styles go here */
/*       :host { */
/*         display: block; */
/*       } */
    </style>
    
    <!-- local DOM goes here -->
<!--     <span>Not much here yet.</span> -->
    
    <nav class="navbar navbar-toggleable-md navbar-light bg-faded">
      <button class="navbar-toggler navbar-toggler-right" type="button" 
        data-toggle="collapse" data-target="#navbarSupportedContent" 
        aria-controls="navbarSupportedContent" aria-expanded="false" 
        aria-label="Toggle navigation"
        data-name="buttonMenuToggle"
        on-click="_click_buttonMenuToggle">
        <span class="navbar-toggler-icon">
            <i class="fa fa-bars" aria-hidden="true"></i>
        </span>
      </button>
      
      <a class="navbar-brand" href="javascript:void(null);">WAW</a>
    
      <div class="collapse navbar-collapse" id="navbarSupportedContent" data-name="menuCollapsable">
        <ul class="navbar-nav mr-auto">
         
<!--           <li class="nav-item active"> -->
<!--             <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a> -->
<!--           </li> -->
<!--           <li class="nav-item"> -->
<!--             <a class="nav-link" href="#">Link</a> -->
<!--           </li> -->
          
<!--           <li class="nav-item"> -->
<!--             <a class="nav-link disabled" href="#">Disabled</a> -->
<!--           </li> -->
          
          <template id="topics_list" is="dom-repeat" items="{{topics}}" as="_topic">
              <li class$="nav-item {{_topic_Class(_topic)}}">
                  <a href="javascript:void(null);" 
                      class="nav-link"
                      on-click="_itemclicked" 
                      data-target$="{{_topic.id}}">{{_topic.name}}</a>
              </li>
          </template>
          
        </ul>
        
<!--         <form class="form-inline my-2 my-lg-0 justify-content-end"> -->
<!--           <input class="form-control mr-sm-2" type="text" placeholder="Search"> -->
<!--           <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button> -->
<!--         </form> -->
        <ul class="navbar-nav justify-content-right">
          <li class="nav-item justify-content-end">
            
            <bs4-dropdown class="nav-item dropdown nav-item dropdown" style="display: block;">
              <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="javascript:void(null);"
                  id="dropdownMenuButton"
                  role="button" aria-haspopup="true" aria-expanded="false">
                  <span class="fa fa-ellipsis-v" aria-hidden="true"></span> Settings
                </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="javascript:void(null);" 
                    on-click="_show_modal_aboutweb">
                      <span class="fa fa-info-circle" aria-hidden="true" data-name="icon"></span>
                      About this web
                </a>
                <a class="dropdown-item" href="javascript:void(null);" 
                    on-click="_show_modal_aboutwaw">
                      <span class="fa fa-info-circle" aria-hidden="true" data-name="icon"></span>
                      About WAW
                </a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="javascript:void(null);"
                    on-click="_download_config">
                      <span class="fa fa-cog" aria-hidden="true" data-name="icon"></span>
                      Get config (JSON)
                </a>
              </div>
            </bs4-dropdown>
          </li>
        </ul>
        
      </div>
    </nav>
    
    <bs4-modal>
      
      <div class="modal fade" tabindex="-1" role="dialog"
        data-name="aboutweb" 
        aria-hidden="true" style="display: none;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLiveLabel">About this web</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">×</span>
                  </button>
              </div>
              <div class="modal-body">
                  <p> This web is a HTML5 application prototype.</p>
                  <p> All the information is stored on remote servers. This application only has a configuration file for access all the data by the client browser.</p>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
<!--                   <button type="button" class="btn btn-primary">Save changes</button> -->
              </div>
            </div>
          </div>
      </div>
      
      
      <div class="modal fade" tabindex="-1" role="dialog"
        data-name="aboutwaw" 
        aria-hidden="true" style="display: none;">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLiveLabel">About WAW</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">×</span>
                  </button>
              </div>
              <div class="modal-body">
                  <p>What about World? (WAW).</p>
                  <p>Is a project that unifies information technologies and the mosts importants topics in life. Of course is only a point of view.</p>
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
<!--                   <button type="button" class="btn btn-primary">Save changes</button> -->
              </div>
            </div>
          </div>
      </div>
            
  </bs4-modal>
    
    
  </template>
  
  
   <script>
   
   
   class WAW_Header extends Polymer.Element {
     static get is() { return "waw-header"; }
     static get properties() {
       return {
         mode: {
             type: String,
             value: 'auto'
           },

         topics: {
             type: Array,
             reflectToAttribute: true,
             notify: true,
             value: function() { return []; }

         }
       }
     }
     
     
     constructor() {
       super();
//        this.textContent = "I'm a custom-element.";
     }
     
     connectedCallback() {
       super.connectedCallback();
     }
     
     _itemclicked(_e, _detail) {

       var _this = this;
//        var _data_target = jQuery(_e.srcElement).attr('data-target');
       var _data_target = _e.model.__data._topic.id;

       
       var _event_Detail = {
           'data-target': _data_target
       };

       _this.dispatchEvent(new CustomEvent('itemclicked', {
           'detail': _event_Detail
       }));

//        _this.fire('itemclicked', {
//            'data-target': _data_target
//            });
         
         // .srcElement.childNodes["0"].data
         // .srcElement.attributes[1]
     }
     
     
     _topic_Class(_topic) {
         return _topic._model.selected === true ? 'active' : '';
     }

     
     _click_buttonMenuToggle(_event) {
         
         var _this = this;
         var _JQ = jQuery;
         
         
         var _button = _JQ(_this.shadowRoot).find('button[data-name="buttonMenuToggle"]');
         var _layer = _JQ(_this.shadowRoot).find('div[data-name="menuCollapsable"]');
      
         _JQ(_layer).toggleClass('collapse');
         _JQ(_layer).toggleClass('active');
         
     }
     
     
     _show_modal_aboutweb(_event) {
         
         var _this = this;
         var _JQ = jQuery;
         
         var _modal = _JQ(_this.shadowRoot).find('div[role="dialog"][data-name="aboutweb"]');
         _modal.modal('show');
         
     }

     _show_modal_aboutwaw(_event) {
         
         var _this = this;
         var _JQ = jQuery;
         
         var _modal = _JQ(_this.shadowRoot).find('div[role="dialog"][data-name="aboutwaw"]');
         _modal.modal('show');
         
     }
     
     _download_config() {
       // window.location.href = "js/config.json";
       window.open('js/config.json');
     }
     
     
     set_topics(_options) {
         
         var _this = this;
         
         _options = (_options !== undefined) ? _options: {};
         var _topics = (_options.topics !== undefined) ? _options.topics : _this.get('topics');
         
          // clear an array
         _this.set('topics', []);
         _this.$.topics_list.render();
      
         _topics.forEach(function(_item, _id){
//              _data.topics.push(_item);

             if (_item._model === undefined) {
                 _item._model = {};
             }
             
             _item._model.selected = (_item._model.selected === true) ? true : false;

             _this.push('topics', _item);
         });
         
     }
     
     
     set_active_topic(_options) {
         
       var _this = this;
       var _topic_ID = _options.topic;
       var _data = _this.data;
       var _topics = _this.topics;
       
       _topics.forEach(function(_topic, _i) {
           _this.set('topics.' + _i + '._model.selected', _topic.id === _topic_ID ? true: false);
           });
       
       _this.set_topics();

     }

     
     
     
       
   }

   
   // Register the new element with the browser
   customElements.define(WAW_Header.is, WAW_Header);
   
  </script>
</dom-module>